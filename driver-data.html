<!DOCTYPE html>
<html lang="ar" dir="rtl">
  <head>
    <meta charset="UTF-8" />
    <title>ØªÙØ§ØµÙŠÙ„ Ø§Ù„Ø³Ø§Ø¦Ù‚</title>
    <link rel="stylesheet" href="css/driver-data.css" />
    <!-- Leaflet CSS -->
    <link rel="stylesheet" href="https://unpkg.com/leaflet/dist/leaflet.css" />
  </head>
  <body>
    <header>
      <h1>ØªÙØ§ØµÙŠÙ„ Ø§Ù„Ø³Ø§Ø¦Ù‚</h1>
      <button onclick="window.location.href='drivers-data.html'">Ø±Ø¬ÙˆØ¹</button>
    </header>

    <main>
      <div class="info-section">
        <img src="images/user-icon.png" class="driver-img" />
        <h2 id="driverName"></h2>
        <p id="driverPhone"></p>
        <p id="nationalId"></p>
        <p id="tukTukNumber"></p>

        <!-- â­ ØªÙ‚ÙŠÙŠÙ… -->
        <div class="rating">
          <span class="star">&#9733;</span>
          <span class="star">&#9733;</span>
          <span class="star">&#9733;</span>
          <span class="star">&#9733;</span>
          <span class="star">&#9734;</span>
        </div>

        <!-- ğŸ“ Ø£Ø²Ø±Ø§Ø± Ø§Ù„ØªÙˆØ§ØµÙ„ -->
        <div class="contact-buttons">
          <a id="callButton" class="btn" target="_blank">ğŸ“ Ø§ØªØµØ§Ù„</a>
          <a id="whatsappButton" class="btn" target="_blank">ğŸ’¬ ÙˆØ§ØªØ³Ø§Ø¨</a>
        </div>
      </div>

      <!-- ğŸ—ºï¸ Ø®Ø±ÙŠØ·Ø© -->
      <div id="map"></div>
    </main>

    <!-- Leaflet JS -->
    <script src="https://unpkg.com/leaflet/dist/leaflet.js"></script>

    <!-- Ø¥Ø¹Ø¯Ø§Ø¯ Ø§Ù„Ø®Ø±ÙŠØ·Ø© -->
    <script>
      const driver = JSON.parse(localStorage.getItem("selectedDriver"));
      if (driver) {
        document.getElementById(
          "driverName"
        ).textContent = `Ø§Ù„Ø§Ø³Ù…: ${driver.driverName}`;
        document.getElementById(
          "driverPhone"
        ).textContent = `Ø±Ù‚Ù… Ø§Ù„Ù‡Ø§ØªÙ: ${driver.driverPhone}`;
        document.getElementById(
          "nationalId"
        ).textContent = `Ø§Ù„Ø±Ù‚Ù… Ø§Ù„Ù‚ÙˆÙ…ÙŠ: ${driver.nationalId}`;
        document.getElementById(
          "tukTukNumber"
        ).textContent = `Ø±Ù‚Ù… Ø§Ù„ØªÙˆÙƒØªÙˆÙƒ: ${driver.tukTukNumber}`;

        const phone = driver.driverPhone.replace(/\s+/g, "");
        document.getElementById("callButton").href = `tel:${phone}`;
        document.getElementById(
          "whatsappButton"
        ).href = `https://wa.me/${phone}`;

        // ğŸŒ Ø¥Ø­Ø¯Ø§Ø«ÙŠØ§Øª Ø·Ù„Ø®Ø§
        let lat = 31.0591;
        let lng = 31.3785;

        const map = L.map("map").setView([lat, lng], 15);
        L.tileLayer("https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png", {
          attribution: "OpenStreetMap",
        }).addTo(map);

        // ğŸ“ Ù…Ø§Ø±ÙƒØ± Ù…ØªØ­Ø±Ùƒ
        const marker = L.marker([lat, lng])
          .addTo(map)
          .bindPopup("Ù…ÙˆÙ‚Ø¹ Ø§Ù„ØªÙˆÙƒØªÙˆÙƒ")
          .openPopup();

        // ğŸƒ Ù…Ø­Ø§ÙƒØ§Ø© Ø­Ø±ÙƒØ© Ø®ÙÙŠÙØ©
        setInterval(() => {
          lat += (Math.random() - 0.5) * 0.0005;
          lng += (Math.random() - 0.5) * 0.0005;
          marker.setLatLng([lat, lng]);
          map.panTo([lat, lng]);
        }, 2000); // ÙƒÙ„ Ø«Ø§Ù†ÙŠØªÙŠÙ† ÙŠØªØ­Ø±Ùƒ
      }
    </script>
  </body>
</html>
